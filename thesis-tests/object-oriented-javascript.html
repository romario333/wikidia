<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script src="lib/jquery-1.7.1.js"></script>
    <link rel="stylesheet" href="lib/qunit-v1.3.0pre.css" type="text/css" media="screen"/>
    <script type="text/javascript" src="lib/qunit-1.3.0pre.js"></script>

    <script>


        $(document).ready(function () {

            "use strict";

            module("Polymorphism");

            test("Duck-typing", function () {
                expect(1);

                var duck = {
                    quack: function () {
                        console.log("quack");
                    }
                };

                if (duck.quack) {
                    ok("Ducks quack, no surprise here.");
                    duck.quack();
                }

                if (duck.bark) {
                    fail("Ducks do not bark, obviously.")
                    duck.bark(); // this would fail
                }
            });

            test("Duck-typing - check that quack is a function", function () {
                expect(1);

                var duck = {
                    quack: function () {
                        console.log("quack");
                    }
                };

                if (duck.quack && typeof duck.quack === "function") {
                    ok("Ducks quack, no surprise here.");
                    duck.quack();
                }
            });

            module("Information Hiding");

            test("Privacy with Closures", function () {
                function newUser(spec) {
                    var that = {}, // public interface
                        password = spec.password;

                    that.login = spec.login;

                    that.authenticate = function (aPassword) {
                        return password === aPassword;
                    };

                    return that;
                }

                var user = newUser({login: "eich", password: "secret"});

                equal(user.login, "eich");
                equal(user.password, undefined);
                equal(user.authenticate("secret"), true);
                equal(user.authenticate("bad secret"), false);
            });


            module("Inheritance");

            module("Prototype-based Inheritance");



            test("Prototype Chain - property setting and retrieval", function () {
                var person = {
                    firstName: "N/A",
                    lastName: "N/A",
                    fullName: function () {
                        return this.firstName + " " + this.lastName;
                    }
                };

                var brandon = Object.create(person);

                equal(brandon.firstName, "N/A");
                equal(brandon.lastName, "N/A");

                brandon.firstName = "Brandon";
                brandon.lastName = "Eich";

                equal(brandon.firstName, "Brandon");
                equal(brandon.lastName, "Eich");

                equal(person.firstName, "N/A");
                equal(person.lastName, "N/A");

                var axel = Object.create(person);
                axel.firstName = "Axel";

                equal(brandon.fullName(), "Brandon Eich");
                equal(axel.fullName(), "Axel N/A"); //TODO:
            });

            test("Inspecting prototype chain from code", function () {
                var person = {
                    firstName: "N/A",
                    lastName: "N/A"
                };

                var brandon = Object.create(person);

                equal(Object.getPrototypeOf(brandon), person);
                equal(Object.getPrototypeOf(person), Object.prototype);
                equal(Object.getPrototypeOf(Object.prototype), null);

                equal(brandon.__proto__, person);
                equal(person.__proto__, Object.prototype);
                equal(Object.prototype.__proto__, null);

                equal(person.isPrototypeOf(brandon), true);
                equal(Object.prototype.isPrototypeOf(brandon), true);
            });

            test("Prototype-based Inheritance with Constructor Functions", function () {
                function Person() {
                    this.firstName = "N/A";
                    this.lastName = "N/A";
                    // implicit return this
                }

                Person.prototype.fullName = function () {
                    return this.firstName + " " + this.lastName;
                };

                var brandon = new Person();
                brandon.firstName = "Brandon";
                brandon.lastName = "Eich";

                equal(brandon.fullName(), "Brandon Eich");

                var axel = new Person();
                axel.firstName = "Axel";
                axel.lastName = "TODO"; // TODO:

                equal(axel.fullName(), "Axel TODO");
            });

            test("Constructor Function can return whatever it wants", function () {
                var cat = {};

                function Dog() {
                    return cat;
                }

                var dog = new Dog();
                equal(dog, cat);
            });

            test("Inheritance by copying - Mixins", function () {
                function applyMixin(object, mixin) {
                    Object.keys(mixin).forEach(function (key) {
                        object[key] = mixin[key];
                    });
                }

                var o = {
                    firstName: "Brandon",
                    lastName: "Eich"
                };

                var debugMixin = {
                    printProperties: function () {
                        var props = [];
                        var keys = Object.keys(this);
                        for (var i in keys) {
                            var key = keys[i];
                            if (typeof this[key] !== "function")
                            props.push(keys[i] + ": " + this[keys[i]]);
                        }
                        return props.join(", ");
                    }
                };

                applyMixin(o, debugMixin);

                equal(o.printProperties(), "firstName: Brandon, lastName: Eich");
            });

            test("Classical Inheritance with Constructor Functions", function () {
                function Person(firstName, lastName) {
                    this.firstName = firstName;
                    this.lastName = lastName;
                }

                Person.prototype.fullName = function () {
                    return this.firstName + " " + this.lastName;
                };

                var brandon = new Person("Brandon", "Eich");
                equal(brandon.fullName(), "Brandon Eich");
                equal(brandon instanceof Person, true);
            });

            module("Modules");

            test("Simple module with Immediately-Invoked Function Expression", function () {
                var MY_APP = MY_APP || {};
                MY_APP.module = {};

                (function () {
                    var exports = MY_APP.module;

                    exports.publicFunc = function () {
                        privateFunc();
                    };

                    function privateFunc() {
                        // do something
                    }
                })();

                var module = MY_APP.module;
                module.publicFunc();
            });

        });




    </script>

</head>
<body>
<h1 id="qunit-header">QUnit example</h1>

<h2 id="qunit-banner"></h2>

<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>